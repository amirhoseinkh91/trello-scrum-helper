<!doctype html>
<html>

<head>
  <meta charset="utf-8">
</head>

<body>
  <script src="https://p.trellocdn.com/power-up.min.js"></script>
  <script>
    var onBtnClick = function (t, opts) {
      var doingListId = t.lists('id', 'name')
        .then(function (list) {
          var doingList = list.filter(function (listItem) {
            return listItem.name == 'doing'
          });
          doingListId = doingList.id
          console.log('selected list as doing is', doingList.name, doingList.id)
        });
      console.log('doing list id is', doingListId)
      t.cards('all').then(function (cards) {
        var doingCards = cards.filter(function (card) {
          return card.listId == doingListId;
        });
        console.log('doing cards are: ', doingCards)
      });
      return t.popup({
        title: 'Estimates',
        items: [{
          text: 'Choose Time',
          callback: function (t, opts) {
            console.log("Choose Time")
           }
        }, {
          text: 'In 1 hour',
          callback: function (t, opts) {
            console.log("In 1 hour")
           }
        }, {
          text: 'In 2 hours',
          callback: function (t, opts) {
            console.log("In 2 hours")
           }
        }]
      });
    };
    TrelloPowerUp.initialize({
      'board-buttons': function (t, options) {
        return [{
          icon: {
            dark: 'https://cdn.hyperdev.com/us-east-1%3A3d31b21c-01a0-4da2-8827-4bc6e88b7618%2Ficon-black.svg',
            light: 'https://cdn.hyperdev.com/us-east-1%3A3d31b21c-01a0-4da2-8827-4bc6e88b7618%2Ficon-white.svg'
          },
          text: 'Show Est.',
          callback: onBtnClick,
          condition: 'edit',
        }];
      }
    })
  </script>
</body>

</html>
